<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>
<script>
	// test
	window.onload = function(){
		// var name = localStorage.username;
		var name = localStorage["username"];
		if(!name) {
			name = prompt("What is your name");
			localStorage.username = name;
		}

		for(var name in localStorage)
		{
			var value = localStorage[name];
		}

		// alert(name);
		localStorage.setItem("x", 1);
		var n = localStorage.getItem("x");
		// localStorage.removeItem("x");
		// console.log(n);
		for(var i = 0; i < localStorage.length; i++)
		{
			var name = localStorage.key(i);
			var value = localStorage.getItem(name);
		}

		// console.log(name); x

		// 兼容多个浏览器
		// var memory = window.localStorage || (window.UserDataStorage && new UserDataStorage()) || new CookieStorage();
		// memory.setItem("y", "hello world");
		// var username = memory.getItem("y");
		// alert(username);

		// 再写一遍
		// var memory = window.localStorage || (window.UserDataStorage && new UserDataStorage()) || new CookieStorage();

	// alert(navigator.cookieEnabled); // firefox not work

	// document.cookie = "version=" + encodeURIComponent(document.lastModified);

	function setCookie(name, value, daysToLive) {
		var cookie = name + "=" + encodeURIComponent(value);
		if(typeof daysToLive === "number") {
			cookie += "; max-age=" + daysToLive*60*60*24;
		}

		document.cookie = cookie;
	}	

	function getCookie() {
		var cookie = {};
		var all = document.cookie;
		if(all === "") {
			return cookie;
		}

		var list = all.split("; ");
		for(var i = 0;i < list.length; i++) {
			var cookie = list[i];
			var p = cookie.indexOf("=");
			var name = cookie.substring(0, p);
			var value = cookie.substring(p+1);
			cookie[name] = value;
		}

		return cookie;
	}

	var memory = document.createElement("div");
	memory.id = "_memory";
	memory.style.display = "none";
	memory.style.behavior = "url(#default#userData)";
	document.body.appendChild(memory);

	memory.load("myStoredData");
	var name = memory.getAttribute("username");
	if(!name) {
		name = prompt("What is your name?");
		memory.setAttribute(" username ", name);
		memory.save("myStoredData");
	}

	var now = (new Data()).getTime();
	var expires = now + 100 * 24 * 60 * 60 * 1000;
	expires = new Date(expires).toUTCString();
	memory.expires = expires;
};

</script>
</body>
</html>